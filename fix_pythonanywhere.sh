#!/bin/bash
# سكريبت لإصلاح خطأ 500 على PythonAnywhere
# يجب تنفيذ هذا السكريبت على خادم PythonAnywhere

echo "==================================="
echo "إصلاح خطأ 500 - Silver Clean App"
echo "==================================="
echo ""

# الخطوة 1: الانتقال إلى مجلد المشروع
echo "[1/4] الانتقال إلى مجلد المشروع..."
cd ~/alasadi12380.pythonanywhere.com || { echo "خطأ: لم يتم العثور على مجلد المشروع"; exit 1; }
echo "✓ تم"
echo ""

# الخطوة 2: تفعيل البيئة الافتراضية
echo "[2/4] تفعيل البيئة الافتراضية..."
source .venv/bin/activate || { echo "خطأ: فشل تفعيل البيئة الافتراضية"; exit 1; }
echo "✓ تم"
echo ""

# الخطوة 3: تطبيق ترحيلات قاعدة البيانات
echo "[3/4] تطبيق ترحيلات قاعدة البيانات..."
flask db upgrade || { echo "خطأ: فشل تطبيق الترحيلات"; exit 1; }
echo "✓ تم"
echo ""

# الخطوة 4: التعليمات النهائية
echo "[4/4] الخطوات النهائية:"
echo "1. ارفع الملف app/__init__.py المحدث إلى PythonAnywhere"
echo "2. اذهب إلى لوحة التحكم في PythonAnywhere"
echo "3. اضغط على زر 'Reload' لإعادة تشغيل التطبيق"
echo "4. اختبر الصفحة الرئيسية: https://alasadi12380.pythonanywhere.com/"
echo ""
echo "==================================="
echo "✓ انتهى تنفيذ السكريبت"
echo "==================================="
